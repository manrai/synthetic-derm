Search.setIndex({"alltitles": {"1. Creating the dataset": [[3, "1.-Creating-the-dataset"]], "2. Train the synthetic image generator": [[3, "2.-Train-the-synthetic-image-generator"]], "3. Generate synthetic images": [[3, "3.-Generate-synthetic-images"]], "4. Training the classifier": [[3, "4.-Training-the-classifier"]], "Conclusion": [[3, "Conclusion"]], "Contents:": [[6, null]], "Indices and tables": [[6, "indices-and-tables"]], "Introduction": [[3, "Introduction"]], "Module contents": [[4, "module-fine_tune"], [5, "module-generation"], [8, "module-utils"]], "Modules": [[7, null]], "Parameters:": [[8, "parameters"]], "Returns:": [[8, "returns"]], "Run the complete experiment": [[2, "Run-the-complete-experiment"]], "Step 1: Setup and Imports": [[2, "Step-1:-Setup-and-Imports"]], "Step 2: Data Loading and Preparation": [[2, "Step-2:-Data-Loading-and-Preparation"]], "Step 3: Experiment Parameters": [[2, "Step-3:-Experiment-Parameters"]], "Step 4: Synthetic Data Generation": [[2, "Step-4:-Synthetic-Data-Generation"]], "Step 5: Model Training with Synthetic Data": [[2, "Step-5:-Model-Training-with-Synthetic-Data"]], "Step 6: Model Evaluation (with Synthetic Data)": [[2, "Step-6:-Model-Evaluation-(with-Synthetic-Data)"]], "Step 7: Baseline Model (No Synthetic Data)": [[2, "Step-7:-Baseline-Model-(No-Synthetic-Data)"]], "Submodules": [[4, "submodules"], [5, "submodules"], [8, "submodules"]], "Training a Dermatology Image Classifier with Synthetic Data": [[2, null]], "Using the synderm dataset": [[0, null]], "Vignette: Augmenting an image classifier with synthetic images from your data": [[3, null]], "fine_tune package": [[4, null]], "fine_tune.inpaint_diffusion module": [[4, "module-fine_tune.inpaint_diffusion"]], "fine_tune.text_to_image_diffusion module": [[4, "module-fine_tune.text_to_image_diffusion"]], "fine_tune.util module": [[4, "module-fine_tune.util"]], "generation package": [[5, null]], "generation.generate module": [[5, "module-generation.generate"]], "generation.util module": [[5, "module-generation.util"]], "synderm documentation": [[6, null]], "utils package": [[8, null]], "utils.utils module": [[8, "module-utils.utils"]]}, "docnames": ["examples/synderm_dataset", "examples/train_fitz_classifier1", "examples/train_fitz_classifier2", "examples/train_with_synthetic_images", "fine_tune", "generation", "index", "modules", "utils"], "envversion": {"nbsphinx": 4, "sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["examples/synderm_dataset.ipynb", "examples/train_fitz_classifier1.ipynb", "examples/train_fitz_classifier2.ipynb", "examples/train_with_synthetic_images.ipynb", "fine_tune.rst", "generation.rst", "index.rst", "modules.rst", "utils.rst"], "indexentries": {"collate_fn() (in module fine_tune.util)": [[4, "fine_tune.util.collate_fn", false]], "count_png_files() (in module utils.utils)": [[8, "utils.utils.count_png_files", false]], "diffusiontrainwrapper (class in fine_tune.util)": [[4, "fine_tune.util.DiffusionTrainWrapper", false]], "encode_prompt() (in module fine_tune.util)": [[4, "fine_tune.util.encode_prompt", false]], "fine_tune": [[4, "module-fine_tune", false]], "fine_tune.inpaint_diffusion": [[4, "module-fine_tune.inpaint_diffusion", false]], "fine_tune.text_to_image_diffusion": [[4, "module-fine_tune.text_to_image_diffusion", false]], "fine_tune.util": [[4, "module-fine_tune.util", false]], "fine_tune_inpaint() (in module fine_tune.inpaint_diffusion)": [[4, "fine_tune.inpaint_diffusion.fine_tune_inpaint", false]], "fine_tune_text_to_image() (in module fine_tune.text_to_image_diffusion)": [[4, "fine_tune.text_to_image_diffusion.fine_tune_text_to_image", false]], "generate_synthetic_dataset() (in module generation.generate)": [[5, "generation.generate.generate_synthetic_dataset", false]], "generation": [[5, "module-generation", false]], "generation.generate": [[5, "module-generation.generate", false]], "generation.util": [[5, "module-generation.util", false]], "generationwrapper (class in generation.util)": [[5, "generation.util.GenerationWrapper", false]], "import_model_class_from_model_name_or_path() (in module fine_tune.util)": [[4, "fine_tune.util.import_model_class_from_model_name_or_path", false]], "load_images() (in module utils.utils)": [[8, "utils.utils.load_images", false]], "module": [[4, "module-fine_tune", false], [4, "module-fine_tune.inpaint_diffusion", false], [4, "module-fine_tune.text_to_image_diffusion", false], [4, "module-fine_tune.util", false], [5, "module-generation", false], [5, "module-generation.generate", false], [5, "module-generation.util", false], [8, "module-utils", false], [8, "module-utils.utils", false]], "promptdataset (class in fine_tune.util)": [[4, "fine_tune.util.PromptDataset", false]], "save() (in module utils.utils)": [[8, "utils.utils.save", false]], "save_images() (in module utils.utils)": [[8, "utils.utils.save_images", false]], "synthetic_train_val_split() (in module utils.utils)": [[8, "utils.utils.synthetic_train_val_split", false]], "tokenize_prompt() (in module fine_tune.util)": [[4, "fine_tune.util.tokenize_prompt", false]], "tokenize_prompt_with_caching() (fine_tune.util.diffusiontrainwrapper method)": [[4, "fine_tune.util.DiffusionTrainWrapper.tokenize_prompt_with_caching", false]], "utils": [[8, "module-utils", false]], "utils.utils": [[8, "module-utils.utils", false]]}, "objects": {"": [[4, 0, 0, "-", "fine_tune"], [5, 0, 0, "-", "generation"], [8, 0, 0, "-", "utils"]], "fine_tune": [[4, 0, 0, "-", "inpaint_diffusion"], [4, 0, 0, "-", "text_to_image_diffusion"], [4, 0, 0, "-", "util"]], "fine_tune.inpaint_diffusion": [[4, 1, 1, "", "fine_tune_inpaint"]], "fine_tune.text_to_image_diffusion": [[4, 1, 1, "", "fine_tune_text_to_image"]], "fine_tune.util": [[4, 2, 1, "", "DiffusionTrainWrapper"], [4, 2, 1, "", "PromptDataset"], [4, 1, 1, "", "collate_fn"], [4, 1, 1, "", "encode_prompt"], [4, 1, 1, "", "import_model_class_from_model_name_or_path"], [4, 1, 1, "", "tokenize_prompt"]], "fine_tune.util.DiffusionTrainWrapper": [[4, 3, 1, "", "tokenize_prompt_with_caching"]], "generation": [[5, 0, 0, "-", "generate"], [5, 0, 0, "-", "util"]], "generation.generate": [[5, 1, 1, "", "generate_synthetic_dataset"]], "generation.util": [[5, 2, 1, "", "GenerationWrapper"]], "utils": [[8, 0, 0, "-", "utils"]], "utils.utils": [[8, 1, 1, "", "count_png_files"], [8, 1, 1, "", "load_images"], [8, 1, 1, "", "save"], [8, 1, 1, "", "save_images"], [8, 1, 1, "", "synthetic_train_val_split"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "terms": {"": [0, 2, 3, 4, 8], "0": [0, 2, 3, 4, 5], "00": [0, 2, 3], "00000": 0, "000000": 0, "000009": 0, "00004": 0, "000e8dd5ee75dd6668e978e7a4e6fe54": 0, "01": 3, "02d": 3, "04": 2, "05": [2, 3], "06": 4, "0x7f210967a0e0": 0, "1": [0, 1, 4, 5, 6], "10": [0, 2, 3], "100": [0, 2, 4], "1000": 0, "10q": 0, "11": [0, 2, 3], "111108": 2, "12": 3, "123": 5, "127845": 2, "128": 2, "1282": 0, "13": [2, 3], "13308lr1e": 3, "136": 0, "1360": 0, "136784": 2, "14": 3, "140000": 3, "1420": 0, "1450": 0, "14845549263775715": 2, "15": 0, "16": [2, 3, 5], "165": 3, "172222": 2, "175000": 2, "18": 3, "182790": 2, "183333": 2, "18888888888888888": 2, "19": [0, 3], "1910": 0, "195": 3, "19744498136010485": 2, "1m": 0, "2": [4, 5, 6], "20": 3, "200": 3, "2000": 0, "200000": 3, "2024": 3, "20241211_182115": 3, "202778": 2, "208": [2, 3], "21": [0, 3], "218": 3, "22": 3, "222222": 2, "223": [2, 3], "224": [0, 2, 3], "228": 2, "22932228514002062": 2, "23": 3, "24": 3, "240000": 3, "24166666666666667": 2, "2420": 0, "2450": 0, "25": [0, 3, 5], "263444": 2, "27": 3, "275000": 2, "283333": 2, "2858883519732285": 2, "291667": 2, "294444": 2, "3": [0, 5, 6], "3000": 0, "32": [2, 3], "320000": 3, "34": 0, "340000": 3, "3420": 0, "3450": 0, "35": 0, "357": 3, "3580": 0, "360": 0, "386": 3, "3862": 3, "387": 3, "389": 3, "39": [0, 2, 3], "390": 3, "3925": 3, "394": 3, "395": 3, "399": 3, "4": [0, 4, 6], "40": [2, 8], "4060": 0, "409": 3, "41": 0, "4120": 0, "419": 3, "42": [3, 5], "420": 0, "44": 2, "4400242546931338": 2, "45": 2, "450": 0, "453256": 2, "463088": 3, "47620795950042477": 2, "48": 3, "49": 3, "49166666666666664": 2, "4926": 3, "4f": 3, "5": [3, 5], "50": [3, 5], "500x334": 3, "500x375": 3, "51": 3, "512": [3, 4, 5], "518641": 2, "5259": 3, "5277777777777778": 2, "5316": 3, "536225": 3, "54": 2, "5433090786401995": 2, "559533": 2, "56": 0, "562016": 2, "562762": 3, "57": [0, 2], "5793475960551309": 2, "580996": 3, "59": 0, "5e": [3, 4], "6": [0, 3, 4], "60": 3, "6065": 3, "617": 0, "6294": 3, "6334": 3, "635431": 2, "635972": 3, "64": [0, 2], "645862": 2, "6475": 3, "6541": 3, "660000": 3, "661138": 2, "680000": 3, "6802": 3, "681080": 3, "6919": 3, "7": 3, "700307": 2, "705556": 2, "708333": 2, "7106": 3, "716667": 2, "7187": 3, "7190": 3, "725000": 2, "7264": 3, "7272": 3, "739314": 2, "7429": 3, "7461": 3, "758843": 2, "760000": 3, "7693": 3, "7711": 3, "7768": 3, "777778": 2, "7892": 3, "7961": 3, "797222": 2, "7983": 3, "8": [0, 2, 3, 4, 5], "800000": 3, "8131": 3, "8138": 3, "816667": 2, "8193": 3, "8235": 3, "8247": 3, "825000": 2, "8256": 3, "825740": 3, "8258": 3, "826281": 2, "827778": 2, "835907": 3, "8599": 3, "860000": 3, "865_910_724": 3, "8802": 3, "9": [2, 3, 5], "900020": 2, "9106": 3, "932132": 2, "9446": 3, "95": [2, 5], "950": [3, 5], "959998": 2, "97": 5, "970": [3, 5], "975043": 3, "983149": 3, "9906": 3, "A": [0, 4, 5], "For": [0, 2, 3], "If": [4, 5, 8], "In": 8, "It": 3, "Not": 8, "Of": 3, "The": [0, 2, 3, 4, 5, 8], "These": 3, "Will": 5, "With": 3, "_": 2, "__getitem__": 3, "__init__": 3, "__key__": 0, "__len__": 3, "__local_path__": 0, "__url__": 0, "_util": [2, 3], "accumul": [3, 4], "accuraci": [2, 3], "achiev": 3, "add": [0, 2, 6], "add_fitzpatrick_scale_to_prompt": 4, "addit": 4, "adher": 5, "adjust": 2, "ai": 3, "align": 5, "all": [0, 2, 3, 4, 8], "all_finetune_inpaint_inpaint_generations1_00_000e8dd5ee75dd6668e978e7a4e6fe54": 0, "all_gener": 2, "allerg": 0, "alpha": [2, 3], "also": [2, 3], "although": 2, "amount": 1, "amp": 3, "an": [2, 4, 5, 6], "ani": 3, "append": [0, 3], "appli": [3, 5], "ar": [0, 2, 3, 4, 5, 8], "arch": [2, 3], "architectur": 2, "arg2": 2, "argmax": 3, "argument": [2, 3], "arrai": [0, 2], "artifact": 3, "assign": 2, "associ": [4, 5], "assum": 1, "astyp": 2, "attention_mask": 4, "augment": [0, 1, 2, 4, 5, 6], "author": 0, "avail": 4, "avg": 3, "avoid": 0, "awar": 0, "axi": 0, "b": [2, 3], "backend": 3, "basal": 0, "base": [2, 3, 4, 5], "basic": 0, "batch": [0, 2, 3, 4, 5], "batch_siz": [0, 2, 3, 5], "batch_tfm": 2, "bearer": 0, "becaus": 5, "befor": 4, "behavior": [2, 3], "below": 3, "benchmark": 3, "better": 1, "beyond": 5, "bias": 3, "bool": 4, "both": [2, 3], "bottom": 3, "break": 0, "bucket": 0, "byte": 0, "bytesio": 0, "cache_dir": 0, "calcul": 2, "callback": 2, "can": [0, 1, 2, 3, 4, 5], "carcinoma": 0, "cassette_play": 3, "caus": 3, "cb": [2, 3], "cell": 0, "center": 5, "center_crop": [4, 5], "chain_saw": 3, "chang": 3, "checkpoint": 4, "church": 3, "ci": 2, "cl": 0, "class": [0, 2, 3, 4, 5, 8], "class_column": [2, 8], "class_count": 0, "class_dir": 3, "class_nam": [0, 3], "classif": [3, 4, 5], "classifi": [1, 6], "classification_report": 3, "close": 5, "co": 0, "code": 2, "collate_fn": [3, 4, 7], "collect": 3, "column": 2, "com": 0, "combin": 8, "command": 4, "common": 2, "comparison": 2, "compat": 0, "complet": 3, "compos": [0, 3], "comput": 4, "concat": 2, "conclus": 6, "condit": [2, 5], "consid": 3, "consist": 8, "constant": [3, 4], "contact": 0, "contain": [3, 4, 5, 8], "content": 7, "continu": [3, 5], "control": 5, "convert": [0, 2, 3], "copi": 2, "core": 3, "correctli": 0, "correspond": 8, "count": [0, 2, 3, 8], "count_png_fil": [7, 8], "counter": 3, "cours": 3, "cpu": 5, "creat": [0, 2, 5, 6], "create_vision_model": 3, "creation": 0, "cross_entropi": 3, "csv": 2, "cuda": 5, "cumcount": 2, "curl": 0, "current": [0, 2, 3, 5], "custom": 3, "data": [0, 1, 4, 5, 6, 8], "data1": 2, "data_dir": 3, "datafram": 2, "dataload": [0, 2, 3], "dataset": [1, 2, 4, 5, 6, 8], "dataset_dir": 3, "date": [2, 3], "dbmi": 2, "debug": 4, "decod": 0, "def": [0, 3], "default": [2, 3, 4, 5, 8], "defin": 2, "definit": 0, "demonstr": [2, 3], "depend": 5, "deprec": [2, 3], "derm": [0, 1, 2, 3], "derm_english_spring": 3, "derm_english_springersync": 3, "dermat": 0, "dermatolog": 2, "dermatologi": [3, 5], "dermatos": 0, "detail": [3, 6], "detect": 3, "determinist": 5, "devic": [3, 5], "df": 2, "df_n": 2, "df_pred": 2, "df_synthet": 2, "dict": 8, "dict_kei": 0, "dictionari": 4, "differ": 0, "diffus": [3, 4, 5], "diffusiontrainwrapp": [4, 7], "digit": 3, "dim": [2, 3], "directori": [2, 3, 4, 5, 8], "directory_path": 8, "diseas": 5, "displai": [0, 3], "distribut": [0, 3], "dl": [2, 3], "dls_n": 2, "doc": 3, "doesn": 5, "dog_experi": 3, "downstream": [4, 5], "dreambooth": 3, "drop": 2, "duplic": 2, "dure": [4, 5], "dynam": 2, "e": [2, 4, 5], "each": [0, 3, 4, 5, 8], "earli": 2, "earlystoppingcallback": [2, 3], "easiest": 3, "effect": 4, "efficientnet": 2, "efficientnet_v2_m": [2, 3], "efficientnet_v2_m_weight": [2, 3], "efficientnetv2": 2, "either": 5, "element": 5, "elif": 2, "els": 2, "embed": 4, "encode_prompt": [4, 7], "encoder_hidden_st": 4, "endswith": 3, "english": 3, "english_spring": 3, "ensur": 3, "entir": [2, 3, 5], "entri": [3, 8], "enum": [2, 3], "enumer": [0, 3], "epoch": [0, 2, 3, 4], "equival": [2, 3], "error": 5, "error_r": [2, 3], "erythematosu": 0, "especi": 2, "essenti": 0, "evalu": 3, "even": 0, "exampl": [3, 4, 5], "excess": 0, "exclud": 8, "exclus": 2, "exist": 5, "experi": 3, "experiment": 3, "experiment_dir": 3, "explicitli": 0, "explor": 2, "extract": 2, "f": [0, 2, 3], "f1": 3, "face": 5, "fairli": 0, "fals": [0, 2, 3, 4, 5], "fastai": [2, 3], "field": [3, 8], "figsiz": 0, "figur": 0, "file": [0, 2, 3, 8], "filenam": 5, "final": 4, "finalfitz17k": 2, "find": 3, "fine": [0, 3, 4], "fine_tun": [3, 6, 7], "fine_tune_inpaint": [4, 7], "fine_tune_text_to_imag": [3, 4, 7], "finetun": [0, 2], "finetune_inpaint": 0, "first": [0, 2, 3], "fit": [2, 3], "fitz": 2, "fitzpatrick17k": 2, "fitzpatrick17k_10label_clean_held_out_set": 2, "fitzpatrick17k_10label_clean_train": 2, "fix": 0, "float": [3, 4, 5, 8], "fn_col": 2, "focus": 2, "folder": [2, 3], "follicul": 0, "follow": 5, "forc": 3, "format": [4, 5], "found": 8, "fraction": 5, "freez": 0, "french_horn": 3, "frequent": 2, "from": [0, 1, 2, 4, 5, 6], "from_df": 2, "fulli": 5, "function": [3, 4, 5], "futur": [2, 3], "g": [4, 5], "gain": 3, "garbage_truck": 3, "gas_pump": 3, "gen_fold": 2, "gener": [1, 4, 6, 7], "generate_synthetic_dataset": [1, 3, 5, 7], "generation_fold": 2, "generation_num": 0, "generation_typ": [2, 3, 5], "generations1": 0, "generationwrapp": [5, 7], "get": [0, 2, 3], "get_pr": [2, 3], "get_token": 0, "given": [4, 5], "go": 0, "golf_bal": 3, "good": 3, "googleapi": 0, "gpu": 4, "gradient": [3, 4], "gradient_accumulation_step": [3, 4], "grid": [3, 5], "groupbi": 2, "gt": [0, 3], "guidanc": 5, "guidance_scal": [3, 5], "h": 0, "handl": [4, 5], "handler": 0, "hang": 3, "happen": 0, "have": [1, 3, 5, 8], "held": 3, "hf_cach": 0, "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": 0, "hf_token": 0, "high": 3, "higher": [3, 5], "histori": 3, "hm": 2, "home": [0, 2, 3], "how": [1, 2, 3, 5], "http": [0, 3], "hub": [4, 5], "hug": 5, "hugginface_repo": 2, "huggingfac": [0, 1, 4], "huggingface_hub": 0, "i": [0, 2, 3, 4, 5], "id": [3, 5, 8], "identifi": [2, 5], "ids_test": 2, "ids_train": 2, "idx": [2, 3], "idx_to_label": 3, "ignore_index": 2, "iloc": 2, "ilsvrc2012_val_00000665": 3, "ilsvrc2012_val_00001968": 3, "ilsvrc2012_val_00002294": 3, "ilsvrc2012_val_00004548": 3, "imag": [0, 4, 5, 6, 8], "image_dir": 2, "image_nam": 3, "image_output_path": 3, "image_path": 3, "imagedataload": 2, "imagenet": [0, 3], "imagenet1k_v1": [2, 3], "imagenette2": 3, "imagenette2_subset": 3, "img": [0, 3], "img_nam": 3, "implement": [3, 5, 8], "import": [0, 1, 3], "import_model_class_from_model_name_or_path": [4, 7], "impress": 3, "improv": 2, "imread": 0, "imshow": 0, "includ": [2, 3, 4, 8], "include_synthet": 2, "index": [2, 5, 6], "indic": [2, 3], "infer": [4, 5], "infinit": 0, "info": 3, "inform": [3, 4], "initi": [1, 4, 5], "inpaint": [0, 2, 4, 5], "inpaint_diffus": 7, "input_id": 4, "insert": [4, 5], "inspect": [3, 5], "instal": 2, "instanc": [4, 5], "instance_prompt": [3, 4, 5], "instance_prompt_encoder_hidden_st": 4, "instantan": 3, "instead": [2, 3], "int": [4, 5, 8], "integr": 4, "intend": 3, "intermedi": [4, 5], "interv": 4, "introduct": 6, "io": 0, "ipynb": 3, "ipython": 3, "is_dir": 3, "is_valid": 2, "isdisjoint": 2, "isin": 2, "item": [0, 3, 8], "item_tfm": 2, "iterabledataset": 0, "itertool": 2, "its": 8, "join": [0, 3], "jpeg": 3, "jpg": [0, 2], "json": 0, "just": 3, "k": [2, 3], "kei": [0, 2], "kernel": 3, "l": 0, "label": [0, 1, 2, 3, 4, 5, 8], "label_col": 2, "label_count": 3, "label_filt": [3, 4, 5], "label_to_idx": 3, "lake": 3, "larger": 4, "lbl": 3, "learn": [2, 3, 4], "learner": [2, 3], "learning_r": [3, 4], "least": [5, 8], "len": [2, 3], "length": [0, 3], "let": 2, "lib": [0, 2, 3], "librari": [2, 3], "lichen": 0, "limit": [2, 8], "list": 3, "listdir": 3, "liter": 5, "ll": 2, "load": [0, 3], "load_dataset": 2, "load_imag": [7, 8], "local": [3, 5], "locat": 2, "log": [3, 4], "login": 3, "loop": 4, "loss": 3, "loss0": 3, "loss_func": 3, "lot": 3, "lower": [0, 3, 5], "lr": 3, "lr_schedul": [3, 4], "lr_warmup_step": [3, 4], "lt": [0, 2, 3], "lupu": 0, "m": 2, "m25k7lpr": 3, "macro": 3, "mai": [2, 3, 5], "main": 0, "make": 3, "make_dataloader_train": 0, "make_sampl": 0, "manrai": 2, "map": [0, 5, 8], "mapping_real_to_synthet": [2, 3, 8], "mask": [4, 5], "mask_fract": [3, 5], "matplotlib": 0, "max": 0, "max_batch_s": 2, "maximum": 8, "md5hash": [0, 2], "me": 3, "mean": [2, 3, 5], "measur": 1, "media": 3, "metadata": [0, 5], "metadata_train": 2, "method": [0, 2, 3], "metric": [2, 3], "might": 0, "min_delta": 2, "minimum": 3, "mix": 0, "mode": 3, "model": [1, 3, 4, 5], "model_path": [3, 5], "model_select": 2, "modifi": 5, "modul": 6, "monitor": [2, 3], "more": [3, 5], "most": [2, 3], "msg": [2, 3], "multi": 5, "multipl": [3, 4, 5], "must": [3, 8], "mutual": 2, "my_dataset": 5, "n": [0, 2, 3], "n_out": 3, "n_real_per_class": [2, 8], "n_real_per_label_list": 2, "n_synthetic_per_class": 8, "n_synthetic_per_r": 2, "n_training_per_label": 2, "name": [0, 4, 5, 8], "ndetail": 3, "necessari": [0, 2], "need": [0, 3, 4], "neutrophil": 0, "new": [2, 3, 5], "newli": 3, "next": 3, "nn": 3, "nnumber": 0, "nob": 2, "nodesplitt": 0, "none": [0, 2, 3, 4, 5, 8], "normal": 2, "note": [0, 4], "notebook": [2, 3], "notimplementederror": [5, 8], "now": [2, 3], "np": [0, 2], "nth": 2, "num": 3, "num_class": 3, "num_generations_per_imag": [3, 5], "num_inference_step": [3, 5], "num_sampl": 4, "num_train_epoch": [3, 4], "num_validation_imag": 4, "num_work": 0, "number": [0, 2, 3, 4, 5, 8], "numpi": [0, 2, 3], "o": [1, 2, 3], "object": [0, 4], "off": 0, "onli": [0, 2, 3, 4, 5, 8], "onlin": 1, "open": 3, "optim": [3, 4], "option": 5, "origin": [3, 5], "other": [2, 3, 5], "our": [0, 2, 3], "out": 3, "outpaint": 5, "output": [3, 5], "output_dir": [3, 4], "output_dir_path": [3, 5], "overfit": 2, "own": 3, "packag": [0, 2, 3, 6, 7], "page": 6, "panda": 2, "parachut": 3, "parallel": 3, "paramet": [3, 4, 5], "part": 5, "particular": 4, "pass": [2, 3], "path": [2, 3, 4, 5, 8], "pathlib": 3, "patienc": [2, 3], "pd": 2, "per": [0, 2, 3, 5, 8], "per_class_test_s": [2, 3, 8], "perform": [1, 2, 3, 4, 5], "phase": 5, "photodermatos": 0, "pil": [0, 3, 4, 5], "pip": 2, "pipe": 0, "pipelin": [0, 3, 4, 5], "planu": 0, "pleas": [0, 2, 3], "plt": 0, "png": [0, 2, 3, 8], "potenti": 0, "precis": 3, "pred": 2, "pred_class": 3, "predict": 2, "preload": 3, "prepar": 4, "present": 3, "pretrain": [2, 3, 4, 5], "pretrained_model_name_or_path": [3, 4], "prevent": 2, "preview": [0, 3], "print": [0, 2, 3, 4], "probabl": 2, "process": [0, 3, 5], "produc": [4, 5], "product": 2, "project": 3, "prompt": [3, 4, 5], "promptdataset": [4, 7], "proper": 2, "proport": [2, 8], "proportion_confint": 2, "provid": [4, 5, 8], "psoriasi": [0, 5], "publaynet": 0, "pull": 1, "pure": 5, "purpos": 3, "py": [0, 2, 3], "pyplot": 0, "python": 2, "python3": [0, 2, 3], "pytorch": [0, 3], "qc": 2, "qualiti": [3, 5], "rais": [5, 8], "random": [5, 8], "random_st": [2, 3, 8], "randomhorizontalflip": 0, "randomli": 4, "randomresizedcrop": 0, "rang": [2, 3], "rate": 4, "read_csv": 2, "real": [2, 3, 5, 8], "real_data": [2, 3, 8], "rebatch": 0, "recal": 3, "recommend": [3, 5], "recreat": 0, "refer": 3, "region": 5, "reli": 5, "relogin": 3, "remain": 8, "remov": [2, 3], "repeat": 5, "replac": 2, "report": 3, "report_to": [3, 4], "repres": [2, 8], "reproduc": 8, "resampl": 0, "reset_index": 2, "resiz": [2, 3, 4], "resolut": [3, 4], "resolv": 0, "restructuredtext": 6, "result": [3, 4, 5], "return": [0, 3, 4, 5], "revis": 4, "rgb": 3, "rich": 3, "row": 3, "run": [0, 3, 5], "runwayml": [4, 5], "same": 3, "sampl": [0, 1, 3, 8], "sample_dataset": 3, "sampledataset": 3, "sarcoidosi": 0, "save": [3, 4, 5, 7, 8], "save_imag": [7, 8], "scale": 5, "scenario": 2, "schedul": 4, "score": [2, 3], "scratch": [0, 3], "script": 2, "sdk": 3, "search": [6, 8], "sed": 0, "see": [3, 6], "seed": [5, 8], "select": 2, "self": 3, "separ": 2, "set": [0, 2, 3, 4, 5, 8], "shard": 0, "shardshuffl": 0, "should": [3, 4, 5, 8], "show": [0, 1], "shuffl": [0, 3], "similar": [3, 5], "simpl": 4, "simplic": 3, "simplifi": 3, "simul": 4, "sinc": [2, 3], "singl": 0, "site": [0, 2, 3], "size": [0, 2, 3, 4, 5], "skin": [2, 5], "skin_classification_with_augment": 2, "sklearn": [2, 3], "slow": 0, "slower": 5, "small": 1, "smaller": 0, "some": 3, "sort": 3, "sourc": [4, 5, 8], "specif": [1, 5], "specifi": [5, 8], "split": [2, 3, 8], "split_by_nod": 0, "springer": 3, "squamou": 0, "squar": 5, "stabilityai": [3, 4], "stabl": [3, 4, 5], "stack": 3, "standin": 3, "start": [0, 3, 5], "start_index": [3, 5], "stat": 2, "statsmodel": 2, "stem": 3, "step": [3, 4, 5], "stop": 2, "storag": 0, "store": 2, "str": [2, 4, 5, 8], "strength_inpaint": [3, 5], "strength_outpaint": [3, 5], "string": [4, 5], "strongli": 5, "subdirectori": 8, "submethod": 0, "submodul": 7, "subset": 3, "substitut": 3, "suggest": 0, "summari": 3, "support": [3, 5], "suppos": 5, "surpress": 4, "sync": 3, "synderm": [1, 2, 3], "syntax": 6, "synthet": [0, 4, 5, 6, 8], "synthetic_data": [2, 3, 5, 8], "synthetic_dataset": 3, "synthetic_train_val_split": [2, 3, 7, 8], "syntheticdataset": 3, "system": [0, 3], "t": [0, 3, 5], "tag": 0, "take": [2, 4], "tar": 0, "target_nam": 3, "task": 5, "tbu": 3, "tbucklei": 0, "templat": [4, 5], "tench": 3, "tensor": 3, "tensorboard": 4, "test": [2, 3], "test_accuraci": 3, "test_data": 2, "test_dataset": 3, "test_dl": 2, "test_load": 3, "test_pr": 3, "test_siz": 8, "test_target": 3, "testdata": 0, "text": [0, 3, 5], "text_encod": 4, "text_encoder_use_attention_mask": 4, "text_to_image_diffus": [3, 7], "textual": 5, "tf": 0, "tfm": 3, "than": [0, 2, 3], "thb286": [0, 2, 3], "thei": 8, "them": 5, "thi": [0, 1, 2, 3, 4, 5], "through": 3, "time": [2, 3, 5], "todo": 2, "token": 4, "tokenize_prompt": [4, 7], "tokenize_prompt_with_cach": [4, 7], "tokenizer_max_length": 4, "top": [2, 3], "top1_acc": 2, "top1_ci_low": 2, "top1_ci_upp": 2, "top1_label": 2, "top1_prob": 2, "top1_prob_arr": 2, "top2_label": 2, "top2_prob": 2, "top2_prob_arr": 2, "top3_acc": 2, "top3_ci_low": 2, "top3_ci_upp": 2, "top3_label": 2, "top3_prob": 2, "top3_prob_arr": 2, "top_n_label": 2, "topk": 2, "torch": [0, 2, 3, 4, 5, 8], "torchvis": [2, 3], "total": [0, 3, 4, 8], "totensor": [0, 3], "tqdm": 3, "tqdmexperimentalwarn": 3, "track": 3, "train": [0, 1, 4, 5, 6, 8], "train_batch_s": [3, 4], "train_data": 8, "train_dataset": [3, 4], "train_fitz_classifier2": 3, "train_load": 3, "train_loss": [2, 3], "train_n": 2, "train_test_split": 2, "train_test_splitt": 2, "trainload": 0, "trainset": 0, "trainset_url": 0, "transform": [0, 3], "true": [0, 2, 3, 4], "true_class": 3, "true_label": 2, "tune": [0, 3, 4], "type": [4, 5, 8], "typic": [0, 5], "unbatch": 0, "unet": 3, "union": 5, "uniqu": [2, 3, 5], "unique_label": 3, "up": [2, 3, 4], "updat": [2, 4], "upgrad": 3, "url": 0, "us": [2, 3, 4, 5, 6], "user": [0, 3], "userwarn": [0, 2, 3], "util": [0, 3, 6, 7], "v": 3, "v2": 2, "val": [2, 3], "val_data": 8, "val_load": 3, "val_n": 2, "valid": [3, 4, 8], "valid_col": 2, "valid_loss": [2, 3], "validation_prompt_format": [3, 4], "validation_step": [3, 4], "valu": 5, "value2": 2, "value_count": 2, "variabl": 2, "variat": 5, "venv": [0, 2, 3], "verbos": [3, 4], "verifi": 2, "version": 3, "view": 3, "vignett": 6, "vision": [2, 3], "vision_learn": 2, "vocab": 2, "w": 3, "walk": 3, "wandb": [2, 3, 4], "want": 5, "warmup": 4, "warn": [0, 2, 3, 4], "warn_and_continu": 0, "wd": 0, "we": [0, 1, 2, 3], "webdataset": 0, "webload": 0, "weight": [2, 3], "well": 3, "what": 0, "where": [2, 4, 5], "which": [0, 3, 4], "while": 2, "with_epoch": 0, "with_prior_preserv": 4, "without": 2, "work": [0, 3], "worker": 0, "would": 5, "wrap": 3, "x": 4, "yield": 5, "you": [2, 3, 5], "young": 3, "your": 6}, "titles": ["Using the synderm dataset", "&lt;no title&gt;", "Training a Dermatology Image Classifier with Synthetic Data", "Vignette: Augmenting an image classifier with synthetic images from your data", "fine_tune package", "generation package", "synderm documentation", "Modules", "utils package"], "titleterms": {"1": [2, 3], "2": [2, 3], "3": [2, 3], "4": [2, 3], "5": 2, "6": 2, "7": 2, "No": 2, "an": 3, "augment": 3, "baselin": 2, "classifi": [2, 3], "complet": 2, "conclus": 3, "content": [4, 5, 6, 8], "creat": 3, "data": [2, 3], "dataset": [0, 3], "dermatologi": 2, "document": 6, "evalu": 2, "experi": 2, "fine_tun": 4, "from": 3, "gener": [2, 3, 5], "imag": [2, 3], "import": 2, "indic": 6, "inpaint_diffus": 4, "introduct": 3, "load": 2, "model": 2, "modul": [4, 5, 7, 8], "packag": [4, 5, 8], "paramet": [2, 8], "prepar": 2, "return": 8, "run": 2, "setup": 2, "step": 2, "submodul": [4, 5, 8], "synderm": [0, 6], "synthet": [2, 3], "tabl": 6, "text_to_image_diffus": 4, "train": [2, 3], "us": 0, "util": [4, 5, 8], "vignett": 3, "your": 3}})