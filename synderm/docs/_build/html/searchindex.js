Search.setIndex({"alltitles": {"1. Creating the dataset": [[4, "1.-Creating-the-dataset"]], "2. Train the synthetic image generator": [[4, "2.-Train-the-synthetic-image-generator"]], "3. Generate synthetic images": [[4, "3.-Generate-synthetic-images"]], "4. Training the classifier": [[4, "4.-Training-the-classifier"]], "Conclusion": [[4, "Conclusion"]], "Contents:": [[7, null]], "Indices and tables": [[7, "indices-and-tables"]], "Introduction": [[4, "Introduction"]], "Module contents": [[5, "module-fine_tune"], [6, "module-generation"], [9, "module-utils"]], "Modules": [[8, null]], "Parameters:": [[9, "parameters"]], "Returns:": [[9, "returns"]], "Run the complete experiment": [[3, "Run-the-complete-experiment"]], "Step 1: Setup and Imports": [[3, "Step-1:-Setup-and-Imports"]], "Step 2: Data Loading and Preparation": [[3, "Step-2:-Data-Loading-and-Preparation"]], "Step 3: Experiment Parameters": [[3, "Step-3:-Experiment-Parameters"]], "Step 4: Synthetic Data Generation": [[3, "Step-4:-Synthetic-Data-Generation"]], "Step 5: Model Training with Synthetic Data": [[3, "Step-5:-Model-Training-with-Synthetic-Data"]], "Step 6: Model Evaluation (with Synthetic Data)": [[3, "Step-6:-Model-Evaluation-(with-Synthetic-Data)"]], "Step 7: Baseline Model (No Synthetic Data)": [[3, "Step-7:-Baseline-Model-(No-Synthetic-Data)"]], "Submodules": [[5, "submodules"], [6, "submodules"], [9, "submodules"]], "Test Notebook": [[1, null]], "Training a Dermatology Image Classifier with Synthetic Data": [[3, null]], "Vignette: Augmenting an image classifier with synthetic images from your data": [[4, null]], "fine_tune package": [[5, null]], "fine_tune.text_to_image_diffusion module": [[5, "module-fine_tune.text_to_image_diffusion"]], "fine_tune.util module": [[5, "module-fine_tune.util"]], "generation package": [[6, null]], "generation.generate module": [[6, "module-generation.generate"]], "generation.util module": [[6, "module-generation.util"]], "synderm documentation": [[7, null]], "utils package": [[9, null]], "utils.utils module": [[9, "module-utils.utils"]]}, "docnames": ["examples/data_exploration", "examples/test", "examples/train_fitz_classifier1", "examples/train_fitz_classifier2", "examples/train_with_synthetic_images", "fine_tune", "generation", "index", "modules", "utils"], "envversion": {"nbsphinx": 4, "sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["examples/data_exploration.ipynb", "examples/test.ipynb", "examples/train_fitz_classifier1.ipynb", "examples/train_fitz_classifier2.ipynb", "examples/train_with_synthetic_images.ipynb", "fine_tune.rst", "generation.rst", "index.rst", "modules.rst", "utils.rst"], "indexentries": {"collate_fn() (in module fine_tune.util)": [[5, "fine_tune.util.collate_fn", false]], "count_png_files() (in module utils.utils)": [[9, "utils.utils.count_png_files", false]], "diffusiontrainwrapper (class in fine_tune.util)": [[5, "fine_tune.util.DiffusionTrainWrapper", false]], "encode_prompt() (in module fine_tune.util)": [[5, "fine_tune.util.encode_prompt", false]], "fine_tune": [[5, "module-fine_tune", false]], "fine_tune.text_to_image_diffusion": [[5, "module-fine_tune.text_to_image_diffusion", false]], "fine_tune.util": [[5, "module-fine_tune.util", false]], "fine_tune_text_to_image() (in module fine_tune.text_to_image_diffusion)": [[5, "fine_tune.text_to_image_diffusion.fine_tune_text_to_image", false]], "generate_synthetic_dataset() (in module generation.generate)": [[6, "generation.generate.generate_synthetic_dataset", false]], "generation": [[6, "module-generation", false]], "generation.generate": [[6, "module-generation.generate", false]], "generation.util": [[6, "module-generation.util", false]], "generationwrapper (class in generation.util)": [[6, "generation.util.GenerationWrapper", false]], "import_model_class_from_model_name_or_path() (in module fine_tune.util)": [[5, "fine_tune.util.import_model_class_from_model_name_or_path", false]], "load_images() (in module utils.utils)": [[9, "utils.utils.load_images", false]], "module": [[5, "module-fine_tune", false], [5, "module-fine_tune.text_to_image_diffusion", false], [5, "module-fine_tune.util", false], [6, "module-generation", false], [6, "module-generation.generate", false], [6, "module-generation.util", false], [9, "module-utils", false], [9, "module-utils.utils", false]], "promptdataset (class in fine_tune.util)": [[5, "fine_tune.util.PromptDataset", false]], "save() (in module utils.utils)": [[9, "utils.utils.save", false]], "save_images() (in module utils.utils)": [[9, "utils.utils.save_images", false]], "synthetic_train_val_split() (in module utils.utils)": [[9, "utils.utils.synthetic_train_val_split", false]], "tokenize_prompt() (in module fine_tune.util)": [[5, "fine_tune.util.tokenize_prompt", false]], "tokenize_prompt_with_caching() (fine_tune.util.diffusiontrainwrapper method)": [[5, "fine_tune.util.DiffusionTrainWrapper.tokenize_prompt_with_caching", false]], "utils": [[9, "module-utils", false]], "utils.utils": [[9, "module-utils.utils", false]]}, "objects": {"": [[5, 0, 0, "-", "fine_tune"], [6, 0, 0, "-", "generation"], [9, 0, 0, "-", "utils"]], "fine_tune": [[5, 0, 0, "-", "text_to_image_diffusion"], [5, 0, 0, "-", "util"]], "fine_tune.text_to_image_diffusion": [[5, 1, 1, "", "fine_tune_text_to_image"]], "fine_tune.util": [[5, 2, 1, "", "DiffusionTrainWrapper"], [5, 2, 1, "", "PromptDataset"], [5, 1, 1, "", "collate_fn"], [5, 1, 1, "", "encode_prompt"], [5, 1, 1, "", "import_model_class_from_model_name_or_path"], [5, 1, 1, "", "tokenize_prompt"]], "fine_tune.util.DiffusionTrainWrapper": [[5, 3, 1, "", "tokenize_prompt_with_caching"]], "generation": [[6, 0, 0, "-", "generate"], [6, 0, 0, "-", "util"]], "generation.generate": [[6, 1, 1, "", "generate_synthetic_dataset"]], "generation.util": [[6, 2, 1, "", "GenerationWrapper"]], "utils": [[9, 0, 0, "-", "utils"]], "utils.utils": [[9, 1, 1, "", "count_png_files"], [9, 1, 1, "", "load_images"], [9, 1, 1, "", "save"], [9, 1, 1, "", "save_images"], [9, 1, 1, "", "synthetic_train_val_split"]]}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "terms": {"": [3, 4, 5, 9], "0": [0, 1, 3, 4, 5, 6], "00": [0, 3, 4], "00000": 0, "000e8dd5ee75dd6668e978e7a4e6fe54": 0, "01": 4, "02d": 4, "04": 3, "05": [3, 4], "06": 5, "0x7fd364184d90": 0, "1": [0, 1, 2, 5, 6, 7], "10": [0, 3, 4], "100": [0, 3, 5], "1000": 1, "1014": 0, "10k": 0, "11": [3, 4], "111108": 3, "1112": 0, "1128": 0, "1140": 0, "1155": 0, "12": [0, 4], "1206": 0, "123": 6, "1242": 0, "127845": 3, "128": 3, "13": [0, 3, 4], "13308lr1e": 4, "136784": 3, "14": 4, "140000": 4, "14845549263775715": 3, "16": [0, 3, 4, 6], "165": 4, "1660": 0, "172222": 3, "175000": 3, "18": 4, "182790": 3, "183333": 3, "18888888888888888": 3, "19": 4, "195": 4, "19744498136010485": 3, "2": [0, 5, 6, 7], "20": 4, "200": 4, "200000": 4, "2024": 4, "20241211_182115": 4, "202778": 3, "208": [3, 4], "21": 4, "2140": 0, "218": 4, "22": 4, "222222": 3, "223": [3, 4], "2231": 0, "2233": 0, "224": [3, 4], "228": 3, "22932228514002062": 3, "23": 4, "24": 4, "240000": 4, "24166666666666667": 3, "25": [4, 6], "263444": 3, "27": 4, "275000": 3, "283333": 3, "2858883519732285": 3, "291667": 3, "294444": 3, "2x3": 0, "3": [0, 6, 7], "300k": 0, "32": [3, 4], "320000": 4, "3331": 0, "3337": 0, "340000": 4, "350k": 0, "357": 4, "367": 0, "386": 4, "3862": 4, "387": 4, "389": 4, "39": [0, 3, 4], "390": 4, "3925": 4, "394": 4, "395": 4, "399": 4, "4": [0, 5, 7], "40": [3, 9], "409": 4, "419": 4, "42": [4, 6], "44": 3, "4400242546931338": 3, "45": [0, 3], "453256": 3, "463088": 4, "47620795950042477": 3, "48": 4, "49": 4, "49166666666666664": 3, "4926": 4, "493": 0, "4f": 4, "5": [0, 1, 4, 6], "50": [4, 6], "500x334": 4, "500x375": 4, "51": 4, "512": [4, 5, 6], "512x512": 0, "518": 0, "518641": 3, "5259": 4, "5277777777777778": 3, "529": 0, "5316": 4, "535": 0, "536225": 4, "54": 3, "541": 0, "5433090786401995": 3, "559533": 3, "562016": 3, "562762": 4, "57": 3, "5793475960551309": 3, "580996": 4, "5e": [4, 5], "6": [0, 1, 4, 5], "60": 4, "6065": 4, "6294": 4, "6334": 4, "635431": 3, "635972": 4, "64": 3, "645862": 3, "6475": 4, "6541": 4, "660000": 4, "661138": 3, "679": 0, "680000": 4, "6802": 4, "681080": 4, "6919": 4, "7": [0, 4], "700307": 3, "705556": 3, "708333": 3, "7106": 4, "716667": 3, "7187": 4, "7190": 4, "725000": 3, "7264": 4, "7272": 4, "739314": 3, "7429": 4, "7461": 4, "752": 0, "758843": 3, "760000": 4, "7693": 4, "7711": 4, "7768": 4, "777778": 3, "778": 0, "7892": 4, "7961": 4, "797": 0, "797222": 3, "7983": 4, "7d8f14bc6c617b6247380f77be1c8b94": 0, "8": [0, 1, 3, 4, 5, 6], "800000": 4, "801": 0, "806": 0, "8131": 4, "8138": 4, "816667": 3, "8193": 4, "8235": 4, "8247": 4, "825000": 3, "8256": 4, "825740": 4, "8258": 4, "826281": 3, "827778": 3, "835907": 4, "839": 0, "8599": 4, "860000": 4, "865_910_724": 4, "8802": 4, "9": [0, 3, 4, 6], "900020": 3, "9106": 4, "932132": 3, "9446": 4, "95": [3, 6], "950": [4, 6], "959998": 3, "97": 6, "970": [4, 6], "975043": 4, "983149": 4, "9906": 4, "A": [5, 6], "For": [3, 4], "If": [5, 6, 9], "In": 9, "It": 4, "Not": 9, "Of": 4, "The": [3, 4, 5, 6, 9], "These": 4, "Will": 6, "With": 4, "_": [0, 3], "__getitem__": 4, "__init__": 4, "__key__": 0, "__len__": 4, "__url__": 0, "_util": [3, 4], "access": 0, "accumul": [4, 5], "accuraci": [3, 4], "achiev": 4, "add": [3, 7], "add_fitzpatrick_scale_to_prompt": 5, "addit": 5, "adher": 6, "adjust": 3, "ai": 4, "align": 6, "all": [0, 3, 4, 5, 9], "all_gener": 3, "allerg": 0, "alpha": [1, 3, 4], "alreadi": 0, "also": [3, 4], "although": 3, "amount": 2, "amp": 4, "an": [3, 5, 6, 7], "ani": 4, "append": [0, 4], "appli": [4, 6], "ar": [3, 4, 5, 6, 9], "arch": [3, 4], "architectur": 3, "arg2": 3, "argmax": 4, "argument": [3, 4], "arrai": 3, "artifact": 4, "assign": 3, "associ": [5, 6], "assum": [0, 2], "astyp": 3, "attention_mask": 5, "augment": [2, 3, 6, 7], "avail": 5, "avg": 4, "ax": 0, "axi": 0, "b": [3, 4], "backend": 4, "barplot": 0, "basal": 0, "base": [3, 4, 5, 6], "batch": [3, 4, 5, 6], "batch_siz": [3, 4, 6], "batch_tfm": 3, "becaus": 6, "befor": 5, "behavior": [3, 4], "below": 4, "benchmark": 4, "better": 2, "beyond": 6, "bias": 4, "bool": 5, "both": [3, 4], "bottom": 4, "break": 0, "cache_dir": 0, "cache_directori": 0, "calcul": 3, "callback": 3, "can": [2, 3, 4, 6], "carcinoma": 0, "cassette_play": 4, "caus": 4, "cb": [3, 4], "cell": 0, "center": 6, "center_crop": [5, 6], "chain_saw": 4, "chang": 4, "checkpoint": 5, "church": 4, "ci": 3, "class": [3, 4, 5, 6, 9], "class_column": [3, 9], "class_dir": 4, "class_nam": 4, "classif": [4, 6], "classifi": [2, 5, 7], "classification_report": 4, "close": 6, "code": 3, "collate_fn": [4, 5, 8], "collect": 4, "column": [0, 3], "combin": 9, "common": 3, "comparison": 3, "complet": 4, "compos": 4, "comput": 5, "concat": 3, "conclus": 7, "condit": [3, 6], "consid": 4, "consist": 9, "constant": [4, 5], "contact": 0, "contain": [4, 5, 6, 9], "content": 8, "continu": [4, 6], "control": 6, "convert": [3, 4], "copi": 3, "core": 4, "correspond": 9, "count": [0, 3, 4, 9], "count_png_fil": [8, 9], "counter": 4, "cours": 4, "cpu": 6, "creat": [0, 1, 3, 6, 7], "create_vision_model": 4, "cross_entropi": 4, "csv": [0, 3], "cuda": 6, "cumcount": 3, "current": [3, 4, 6], "custom": 4, "data": [0, 1, 2, 5, 6, 7, 9], "data1": 3, "data_dir": 4, "datafram": [0, 3], "dataload": [3, 4], "dataset": [0, 2, 3, 5, 6, 7, 9], "dataset_dir": 4, "dataset_iter": 0, "date": [3, 4], "dbmi": 3, "debug": 5, "def": 4, "default": [3, 4, 5, 6, 9], "defin": 3, "demonstr": [3, 4], "depend": 6, "deprec": [3, 4], "derm": [0, 3, 4], "derm_english_spring": 4, "derm_english_springersync": 4, "dermat": 0, "dermatolog": 3, "dermatologi": [4, 6], "dermatos": 0, "detail": [4, 7], "detect": 4, "determinist": 6, "devic": [4, 6], "df": [0, 3], "df_n": 3, "df_pred": 3, "df_synthet": 3, "dict": 9, "dictionari": 5, "diffus": [4, 5, 6], "diffusiontrainwrapp": [5, 8], "digit": 4, "dim": [3, 4], "directori": [3, 4, 5, 6, 9], "directory_path": 9, "diseas": 6, "displai": [0, 4], "distribut": [0, 4], "dl": [3, 4], "dls_n": 3, "doc": 4, "doesn": 6, "dog_experi": 4, "downstream": 6, "dreambooth": 4, "drop": 3, "duplic": 3, "dure": [5, 6], "dynam": 3, "e": [3, 5, 6], "each": [4, 5, 6, 9], "earli": 3, "earlystoppingcallback": [3, 4], "easiest": 4, "effect": 5, "efficientnet": 3, "efficientnet_v2_m": [3, 4], "efficientnet_v2_m_weight": [3, 4], "efficientnetv2": 3, "either": 6, "element": 6, "elif": 3, "els": 3, "embed": 5, "encode_prompt": [5, 8], "encoder_hidden_st": 5, "endswith": 4, "english": 4, "english_spring": 4, "ensur": 4, "entir": [3, 4, 6], "entri": [0, 4, 9], "enum": [3, 4], "enumer": [0, 4], "epoch": [3, 4, 5], "equival": [3, 4], "error": 6, "error_r": [3, 4], "erythematosu": 0, "especi": 3, "evalu": 4, "exampl": [0, 4, 5, 6], "exclud": 9, "exclus": 3, "exist": 6, "experi": 4, "experiment": 4, "experiment_dir": 4, "explor": 3, "extract": 3, "f": [0, 3, 4], "f1": 4, "face": 6, "fals": [3, 4, 5, 6], "fastai": [3, 4], "fda33262852d9aa8f0bf96650bdf1c40e1b7c584": 0, "field": [4, 9], "fig": 0, "figsiz": [0, 1], "figur": [0, 1], "file": [3, 4, 9], "filenam": 6, "final": 5, "finalfitz17k": 3, "find": 4, "fine": [4, 5], "fine_tun": [4, 7, 8], "fine_tune_text_to_imag": [4, 5, 8], "finetun": 3, "finetune_inpaint": 0, "finetune_inpaint_all_inpaint": 0, "finetune_text_to_imag": 0, "first": [0, 3, 4], "fit": [3, 4], "fitz": 3, "fitz_merg": 0, "fitz_metadata": 0, "fitzpatrick17k": [0, 3], "fitzpatrick17k_10label_clean_held_out_set": 3, "fitzpatrick17k_10label_clean_train": 3, "flatten": 0, "float": [4, 5, 6, 9], "fn_col": 3, "focus": 3, "folder": [3, 4], "follicul": 0, "follow": 6, "fontsiz": 0, "forc": 4, "format": [5, 6], "found": 9, "fraction": 6, "french_horn": 4, "frequent": 3, "from": [0, 2, 3, 5, 6, 7], "from_df": 3, "fulli": 6, "function": [4, 5, 6], "futur": [3, 4], "g": [5, 6], "gain": 4, "garbage_truck": 4, "gas_pump": 4, "gen_fold": 3, "gener": [1, 2, 5, 7, 8], "generate_synthetic_dataset": [2, 4, 6, 8], "generation_fold": 3, "generation_num": 0, "generation_typ": [3, 4, 6], "generationwrapp": [6, 8], "get": [0, 3, 4], "get_pr": [3, 4], "given": [5, 6], "golf_bal": 4, "good": 4, "gpu": 5, "gradient": [4, 5], "gradient_accumulation_step": [4, 5], "grid": [0, 1, 4, 6], "group": 0, "groupbi": [0, 3], "groups_with_six_or_mor": 0, "gt": [0, 4], "guidanc": 6, "guidance_scal": [4, 6], "ha": 0, "handl": [5, 6], "hang": 4, "hash": 0, "have": [2, 4, 6, 9], "held": 4, "hf": 0, "hf_cach": 0, "high": 4, "higher": [4, 6], "histori": 4, "hm": 3, "home": [3, 4], "how": [2, 3, 4, 6], "http": 4, "hub": [5, 6], "hug": 6, "hugginface_repo": 3, "huggingfac": [2, 5], "i": [0, 3, 4, 5, 6], "id": [4, 6, 9], "identifi": [3, 6], "ids_test": 3, "ids_train": 3, "idx": [0, 3, 4], "idx_to_label": 4, "ignore_index": 3, "iloc": [0, 3], "ilsvrc2012_val_00000665": 4, "ilsvrc2012_val_00001968": 4, "ilsvrc2012_val_00002294": 4, "ilsvrc2012_val_00004548": 4, "imag": [0, 5, 6, 7, 9], "image_dir": 3, "image_index": 0, "image_nam": 4, "image_output_path": 4, "image_path": 4, "imagedataload": 3, "imagenet": 4, "imagenet1k_v1": [3, 4], "imagenette2": 4, "imagenette2_subset": 4, "img": [0, 4], "img_nam": 4, "implement": [4, 6, 9], "import": [0, 1, 2, 4], "import_model_class_from_model_name_or_path": [5, 8], "impress": 4, "improv": [3, 5], "imshow": 0, "includ": [3, 4, 5, 9], "include_synthet": 3, "index": [0, 3, 6, 7], "indic": [0, 3, 4], "infer": [5, 6], "info": 4, "inform": [4, 5], "initi": [5, 6], "inpaint": [0, 3, 6], "input_id": 5, "insert": [5, 6], "inspect": [4, 6], "instal": 3, "instanc": [5, 6], "instance_prompt": [4, 5, 6], "instance_prompt_encoder_hidden_st": 5, "instantan": 4, "instead": [3, 4], "int": [5, 6, 9], "integr": 5, "intend": 4, "intermedi": [5, 6], "interv": 5, "introduct": 7, "io": 0, "ipynb": 4, "ipython": [0, 4], "is_dir": 4, "is_valid": 3, "isdisjoint": 3, "isin": 3, "item": [4, 9], "item_tfm": 3, "iter": 0, "itertool": 3, "its": 9, "join": 4, "jpeg": 4, "jpg": 3, "json": 0, "json_data": 0, "just": 4, "k": [3, 4], "kei": 3, "kernel": 4, "label": [0, 3, 4, 5, 6, 9], "label_col": 3, "label_count": [0, 4], "label_filt": [4, 5, 6], "label_fitz": 0, "label_to_idx": 4, "lake": 4, "larger": 5, "lbl": 4, "learn": [3, 4, 5], "learner": [3, 4], "learning_r": [4, 5], "least": [6, 9], "len": [3, 4], "length": 4, "let": 3, "lib": [3, 4], "librari": [3, 4], "lichen": 0, "limit": [3, 9], "list": 4, "listdir": 4, "liter": 6, "ll": 3, "load": [0, 4], "load_dataset": [0, 3], "load_imag": [8, 9], "local": [4, 6], "locat": 3, "log": [4, 5], "login": 4, "loop": 5, "loss": 4, "loss0": 4, "loss_func": 4, "lot": 4, "lower": [4, 6], "lr": 4, "lr_schedul": [4, 5], "lr_warmup_step": [4, 5], "lt": [0, 3, 4], "lupu": 0, "m": 3, "m25k7lpr": 4, "macro": 4, "mai": [3, 4, 6], "make": 4, "manrai": 3, "map": [6, 9], "mapping_real_to_synthet": [3, 4, 9], "mask": 6, "mask_fract": [4, 6], "matching_entri": 0, "matching_indic": 0, "matplotlib": [0, 1], "max_batch_s": 3, "maximum": 9, "md5": 0, "md5hash": [0, 3], "me": 4, "mean": [3, 4, 6], "media": 4, "merg": 0, "metadata": [0, 6], "metadata_train": 3, "method": [0, 3, 4], "method_submethod": 0, "method_submethod_count": 0, "metric": [3, 4], "min_delta": 3, "minimum": 4, "mode": [0, 4], "model": [4, 5, 6], "model_path": [4, 6], "model_select": 3, "modifi": 6, "modul": 7, "monitor": [3, 4], "more": [4, 6], "most": [3, 4], "msg": [3, 4], "multi": 6, "multipl": [4, 5, 6], "must": [4, 9], "mutual": 3, "my_dataset": 6, "n": [0, 3, 4], "n_out": 4, "n_real_per_class": [3, 9], "n_real_per_label_list": 3, "n_synthetic_per_class": 9, "n_synthetic_per_r": 3, "n_training_per_label": 3, "name": [0, 5, 6, 9], "ndetail": 4, "necessari": 3, "need": [4, 5], "neutrophil": 0, "new": [3, 4, 6], "newli": 4, "next": [0, 4], "nmd5": 0, "nmethod": 0, "nn": 4, "nob": 3, "none": [3, 4, 5, 6, 9], "normal": 3, "note": 5, "notebook": [3, 4], "notimplementederror": [6, 9], "now": [3, 4], "np": [1, 3], "nsubmethod": 0, "nth": 3, "num": 4, "num_class": 4, "num_generations_per_imag": [4, 6], "num_inference_step": [4, 6], "num_sampl": 5, "num_train_epoch": [4, 5], "num_validation_imag": 5, "number": [0, 3, 4, 5, 6, 9], "numpi": [1, 3, 4], "nuniqu": 0, "o": [0, 3, 4], "object": 5, "off": 0, "one": 0, "onli": [0, 3, 4, 5, 6, 9], "open": 4, "optim": [4, 5], "option": 6, "origin": [4, 6], "other": [3, 4, 6], "our": [3, 4], "out": 4, "outpaint": [0, 6], "outpaint_00_000e8dd5ee75dd6668e978e7a4e6fe54": 0, "output": [4, 6], "output_dir": [4, 5], "output_dir_path": [4, 6], "overfit": 3, "own": 4, "packag": [3, 4, 7, 8], "page": 7, "pair": 0, "panda": [0, 3], "parachut": 4, "parallel": 4, "paramet": [4, 5, 6], "part": 6, "particular": 5, "pass": [3, 4], "path": [3, 4, 5, 6, 9], "pathlib": 4, "patienc": [3, 4], "pd": [0, 3], "per": [3, 4, 6, 9], "per_class_test_s": [3, 4, 9], "perform": [3, 4, 5, 6], "phase": 6, "photodermatos": 0, "pil": [0, 4, 5, 6], "pip": 3, "pipelin": [4, 5, 6], "planu": 0, "pleas": [3, 4], "plot": [0, 1], "plt": [0, 1], "png": [0, 3, 4, 9], "pngimagefil": 0, "pngimageplugin": 0, "precis": 4, "pred": 3, "pred_class": 4, "predict": 3, "preload": 4, "prepar": 5, "present": 4, "pretrain": [3, 4, 5, 6], "pretrained_inpaint": 0, "pretrained_model_name_or_path": [4, 5], "pretrained_text_to_imag": 0, "prevent": 3, "preview": 4, "print": [0, 3, 4, 5], "probabl": 3, "process": [4, 6], "produc": [5, 6], "product": 3, "project": 4, "prompt": [4, 5, 6], "promptdataset": [5, 8], "proper": 3, "proport": [3, 9], "proportion_confint": 3, "provid": [5, 6, 9], "psoriasi": [0, 6], "pure": 6, "purpos": 4, "py": [3, 4], "pyplot": [0, 1], "python": 3, "python3": [3, 4], "pytorch": 4, "qc": 3, "qualiti": [4, 6], "rais": [6, 9], "randn": 1, "random": [1, 6, 9], "random_st": [3, 4, 9], "rang": [0, 3, 4], "rate": 5, "read_csv": [0, 3], "real": [3, 4, 6, 9], "real_data": [3, 4, 9], "recal": 4, "recommend": [4, 6], "refer": 4, "region": 6, "reli": 6, "relogin": 4, "remain": 9, "remov": [3, 4], "renam": 0, "repeat": 6, "replac": 3, "report": 4, "report_to": [4, 5], "repres": [3, 9], "reproduc": 9, "reset_index": [0, 3], "resiz": [3, 4, 5], "resolut": [4, 5], "restructuredtext": 7, "result": [4, 5, 6], "return": [4, 5, 6], "revis": 5, "rgb": [0, 4], "rich": 4, "right": 0, "rotat": 0, "row": 4, "run": [4, 6], "runwayml": 6, "same": [0, 4], "sampl": [0, 2, 4, 9], "sample_dataset": 4, "sampledataset": 4, "sarcoidosi": 0, "save": [4, 5, 6, 8, 9], "save_imag": [8, 9], "scale": 6, "scatter": 1, "scenario": 3, "schedul": 5, "score": [3, 4], "scratch": [0, 4], "script": 3, "sdk": 4, "seaborn": 0, "search": [7, 9], "see": [4, 7], "seed": [6, 9], "select": [0, 3], "selected_group": 0, "selected_md5hash": 0, "selected_method": 0, "selected_sampl": 0, "selected_submethod": 0, "self": 4, "separ": 3, "set": [3, 4, 5, 6, 9], "set_titl": 0, "shard": 0, "should": [4, 5, 6, 9], "show": [0, 1, 2], "shuffl": 4, "similar": [4, 6], "simpl": 5, "simplic": 4, "simplifi": 4, "simul": 5, "sinc": [3, 4], "site": [3, 4], "size": [0, 3, 4, 5, 6], "skin": [3, 6], "skin_classification_with_augment": 3, "skip": 0, "sklearn": [3, 4], "slower": 6, "small": 2, "sn": 0, "some": 4, "sort": 4, "sourc": [5, 6, 9], "specif": 6, "specifi": [6, 9], "split": [3, 4, 9], "springer": 4, "squamou": 0, "squar": 6, "stabilityai": [4, 5], "stabl": [4, 5, 6], "stack": 4, "standin": 4, "start": [4, 6], "start_index": [4, 6], "stat": 3, "statsmodel": 3, "stem": 4, "step": [4, 5, 6], "stop": 3, "store": 3, "str": [3, 5, 6, 9], "stream": 0, "strength_inpaint": [4, 6], "strength_outpaint": [4, 6], "string": [5, 6], "strongli": 6, "subdirectori": 9, "submethod": 0, "submodul": 8, "subplot": 0, "subplots_adjust": 0, "subset": [0, 4], "substitut": 4, "summari": 4, "support": [4, 6], "suppos": 6, "suptitl": 0, "surpress": 5, "sync": 4, "synderm": [2, 3, 4], "syntax": 7, "synthet": [0, 5, 6, 7, 9], "synthetic_data": [3, 4, 6, 9], "synthetic_dataset": 4, "synthetic_train_val_split": [3, 4, 8, 9], "syntheticdataset": 4, "system": 4, "t": [0, 4, 6], "take": [0, 3], "tar": 0, "target_nam": 4, "task": 6, "tbu": 4, "tbucklei": 0, "templat": [5, 6], "tench": 4, "tensor": 4, "tensorboard": 5, "test": [3, 4], "test_accuraci": 4, "test_data": 3, "test_dataset": 4, "test_dl": 3, "test_load": 4, "test_pr": 4, "test_siz": 9, "test_target": 4, "text": [0, 4, 6], "text_encod": 5, "text_encoder_use_attention_mask": 5, "text_to_image_diffus": [4, 8], "textual": 6, "tfm": 4, "than": [3, 4], "thb286": [0, 3, 4], "thei": 9, "them": 6, "thi": [2, 3, 4, 5, 6], "through": 4, "tight_layout": 0, "time": [0, 3, 4, 6], "titl": [0, 1], "todo": 3, "token": 5, "tokenize_prompt": [5, 8], "tokenize_prompt_with_cach": [5, 8], "tokenizer_max_length": 5, "tolist": 0, "top": [0, 3, 4], "top1_acc": 3, "top1_ci_low": 3, "top1_ci_upp": 3, "top1_label": 3, "top1_prob": 3, "top1_prob_arr": 3, "top2_label": 3, "top2_prob": 3, "top2_prob_arr": 3, "top3_acc": 3, "top3_ci_low": 3, "top3_ci_upp": 3, "top3_label": 3, "top3_prob": 3, "top3_prob_arr": 3, "top_n_label": 3, "topk": 3, "torch": [3, 4, 5, 6, 9], "torchvis": [3, 4], "total": [4, 5, 9], "totensor": 4, "tqdm": 4, "tqdmexperimentalwarn": 4, "track": 4, "train": [0, 2, 5, 6, 7, 9], "train_batch_s": [4, 5], "train_data": 9, "train_dataset": [4, 5], "train_fitz_classifier2": 4, "train_load": 4, "train_loss": [3, 4], "train_n": 3, "train_test_split": 3, "train_test_splitt": 3, "transform": 4, "true": [0, 1, 3, 4, 5], "true_class": 4, "true_label": 3, "tune": [4, 5], "type": [5, 6, 9], "typic": 6, "unet": 4, "union": 6, "uniqu": [0, 3, 4, 6], "unique_label": 4, "unique_md5hash_count": 0, "unknown": 0, "up": [3, 4, 5], "updat": [3, 5], "upgrad": 4, "us": [3, 4, 5, 6, 7], "user": [0, 4], "userwarn": [3, 4], "util": [4, 7, 8], "v": 4, "v2": 3, "val": [3, 4], "val_data": 9, "val_load": 4, "val_n": 3, "valid": [4, 5, 9], "valid_col": 3, "valid_loss": [3, 4], "validation_prompt_format": [4, 5], "validation_step": [4, 5], "valu": [0, 1, 6], "value2": 3, "value_count": [0, 3], "variabl": 3, "variat": 6, "venv": [3, 4], "verbos": [4, 5], "verifi": 3, "version": 4, "view": 4, "vignett": 7, "vision": [3, 4], "vision_learn": 3, "vocab": 3, "w": 4, "walk": 4, "wandb": [3, 4, 5], "want": 6, "warmup": 5, "warn": [3, 4, 5], "we": [2, 3, 4], "weight": [3, 4], "well": 4, "where": [3, 5, 6], "which": [4, 5], "while": 3, "with_prior_preserv": 5, "without": 3, "work": 4, "would": 6, "wrap": 4, "x": [0, 1, 5], "xlabel": [0, 1], "xtick": 0, "y": [0, 1], "yield": 6, "ylabel": [0, 1], "you": [3, 4, 6], "young": 4, "your": [0, 7], "zip": 0}, "titles": ["&lt;no title&gt;", "Test Notebook", "&lt;no title&gt;", "Training a Dermatology Image Classifier with Synthetic Data", "Vignette: Augmenting an image classifier with synthetic images from your data", "fine_tune package", "generation package", "synderm documentation", "Modules", "utils package"], "titleterms": {"1": [3, 4], "2": [3, 4], "3": [3, 4], "4": [3, 4], "5": 3, "6": 3, "7": 3, "No": 3, "an": 4, "augment": 4, "baselin": 3, "classifi": [3, 4], "complet": 3, "conclus": 4, "content": [5, 6, 7, 9], "creat": 4, "data": [3, 4], "dataset": 4, "dermatologi": 3, "document": 7, "evalu": 3, "experi": 3, "fine_tun": 5, "from": 4, "gener": [3, 4, 6], "imag": [3, 4], "import": 3, "indic": 7, "introduct": 4, "load": 3, "model": 3, "modul": [5, 6, 8, 9], "notebook": 1, "packag": [5, 6, 9], "paramet": [3, 9], "prepar": 3, "return": 9, "run": 3, "setup": 3, "step": 3, "submodul": [5, 6, 9], "synderm": 7, "synthet": [3, 4], "tabl": 7, "test": 1, "text_to_image_diffus": 5, "train": [3, 4], "util": [5, 6, 9], "vignett": 4, "your": 4}})